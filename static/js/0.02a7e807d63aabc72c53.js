webpackJsonp([0],{h5XV:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("mt/N"),i={props:{roads:{type:Array},roadsCurrentShow:{default:void 0}},data:function(){return{winHeight:null}},watch:{roadsCurrentShow:function(t){this.$refs.currentRoadsPointsTable.setCurrentRow(t)}},computed:{currentPath:function(){if(Array.isArray(this.roads))return this.roads[this.$root.currentEditingPathIndex]}},methods:{triggerCurrentFromTable:function(t,n){t&&(t.active=!0),n&&delete n.active,this.$emit("update")},insertPoint:function(t,n){var e,r=this.currentPath[t],i=void 0,a=void 0;if(n<0){if(t>0)i=this.currentPath[t-1];else{var o=this.currentPath[t+1],s={x:r.x-o.x,y:r.y-o.y};i={x:r.x+s.x,y:r.y+s.y}}a=t}else{if(t===this.currentPath.length-1){var u=this.currentPath[t-1],c={x:r.x-u.x,y:r.y-u.y};i={x:r.x+c.x,y:r.y+c.y}}else i=this.currentPath[t+1];a=t+1}e={x:parseInt((r.x+i.x)/2),y:parseInt((r.y+i.y)/2)},this.roads[this.$root.currentEditingPathIndex].splice(a,0,e)},deleteCurrentPathPoint:function(t){this.roads[this.$root.currentEditingPathIndex].splice(t,1)},addPath:function(){this.$root.currentEditingPathIndex?this.roads.splice(this.$root.currentEditingPathIndex,1,r.a(this.currentPath)):this.roads.push(r.a(this.currentPath)),this.$root.currentEditingPathIndex=null,this.savePath()},clearPath:function(){this.$set(this.roads,this.$root.currentEditingPathIndex,[])},deletePath:function(t){var n=this;this.$confirm("删除路径"+(t+1)+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.$root.currentEditingPathIndex=null,n.roads.splice(t,1),n.savePath()})},unchoosePath:function(){this.$root.currentEditingPathIndex=null},choosePath:function(t){if(this.$root.currentEditingPathIndex===t)return this.unchoosePath();this.$root.currentEditingPathIndex=t},savePath:function(){this.$emit("savePath")}},mounted:function(){this.winHeight=window.innerHeight}},a={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("div",{staticClass:"m pathList"},t._l(t.roads,function(n,r){return e("el-tag",{key:"road"+r,staticClass:"_pathtag",attrs:{type:r===t.$root.currentEditingPathIndex?"success":"info"},nativeOn:{click:function(n){return t.choosePath(r)}}},[t._v("路径"+t._s(r+1))])}),1),t._v(" "),e("el-table",{ref:"currentRoadsPointsTable",staticStyle:{width:"100%"},attrs:{"empty-text":"在左侧地图上开始绘制",height:t.winHeight-360,data:t.currentPath,"highlight-current-row":!0},on:{"current-change":t.triggerCurrentFromTable}},[e("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),e("el-table-column",{attrs:{label:"坐标",width:"150"},scopedSlots:t._u([{key:"default",fn:function(n){return[t._v("\n        X: "+t._s(n.row.x)+" Y: "+t._s(n.row.y)+"\n      ")]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"关联建筑"},scopedSlots:t._u([{key:"default",fn:function(n){return[n.row.connectBuildings?e("div",[t._v("\n          "+t._s(n.row.connectBuildings.join("、"))+"\n        ")]):t._e()]}}])}),t._v(" "),e("el-table-column",{attrs:{label:"操作",width:"280",align:"center"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.insertPoint(n.$index,-1)}}},[t._v("前添加")]),t._v(" "),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.insertPoint(n.$index,1)}}},[t._v("后添加")]),t._v(" "),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.deleteCurrentPathPoint(n.$index)}}},[t._v("删除")])]}}])})],1),t._v(" "),e("div",{staticClass:"tc m"},[e("el-button",{attrs:{type:"primary",disabled:!t.currentPath||!t.currentPath.length},on:{click:t.addPath}},[t._v("保存路径")]),t._v(" "),e("el-button",{attrs:{disabled:!t.currentPath||!t.currentPath.length},on:{click:t.clearPath}},[t._v("清除节点")]),t._v(" "),e("el-button",{attrs:{type:"danger",disabled:!t.$root.currentEditingPathIndex},on:{click:function(n){return t.deletePath(t.$root.currentEditingPathIndex)}}},[t._v("删除路径")])],1)],1)},staticRenderFns:[]};var o=e("C7Lr")(i,a,!1,function(t){e("ysuz")},"data-v-a166ef72",null);n.default=o.exports},ysuz:function(t,n){}});